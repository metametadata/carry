<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><link href="css/default.css" rel="stylesheet" type="text/css" /><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>carry-history.core documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Carry</span> <span class="project-version">0.3.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>carry-debugger</span></div></div></li><li class="depth-2"><a href="carry-debugger.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry-history</span></div></div></li><li class="depth-2 current"><a href="carry-history.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry-logging</span></div></div></li><li class="depth-2"><a href="carry-logging.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry-persistence</span></div></div></li><li class="depth-2"><a href="carry-persistence.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry-reagent</span></div></div></li><li class="depth-2"><a href="carry-reagent.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>carry-schema</span></div></div></li><li class="depth-2"><a href="carry-schema.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="carry-history.core.html#var-add"><div class="inner"><span>add</span></div></a></li><li class="depth-1"><a href="carry-history.core.html#var-HistoryProtocol"><div class="inner"><span>HistoryProtocol</span></div></a></li><li class="depth-2 branch"><a href="carry-history.core.html#var-token-.3Ehref"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>token-&gt;href</span></div></a></li><li class="depth-2 branch"><a href="carry-history.core.html#var-replace-token"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>replace-token</span></div></a></li><li class="depth-2 branch"><a href="carry-history.core.html#var-push-token"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>push-token</span></div></a></li><li class="depth-2 branch"><a href="carry-history.core.html#var-token"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>token</span></div></a></li><li class="depth-2"><a href="carry-history.core.html#var-listen"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>listen</span></div></a></li><li class="depth-1"><a href="carry-history.core.html#var-link"><div class="inner"><span>link</span></div></a></li><li class="depth-1"><a href="carry-history.core.html#var-new-hash-history"><div class="inner"><span>new-hash-history</span></div></a></li><li class="depth-1"><a href="carry-history.core.html#var-new-history"><div class="inner"><span>new-history</span></div></a></li><li class="depth-1"><a href="carry-history.core.html#var-new-legacy-hash-history"><div class="inner"><span>new-legacy-hash-history</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">carry-history.core</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-add"><h3>add</h3><div class="usage"><code>(add spec history)</code></div><div class="doc"><div class="markdown"><p>Applies middleware which syncs app model with browser history.</p>
<p>After start it begins catching history events and updates ::token in model accordingly. If ::token changes in model (e.g. by toggling action in debugger), then current url is replaced using new token. Initial ::token value will be applied on clicking debugger’s Reset.</p>
<p>Sends [::on-enter token] signal to app after handling token change event initiated from browser (e.g. on clicking Back button). So using HistoryProtocol’s replace-token/push-token would not trigger this signal. You can still force sending this signal by passing {:treat-as-browser-event? true} event-data to these functions.</p>
<p>Middleware is friendly to carry-debugger: it won’t automatically dispatch initial signal on app start if debugger’s replay mode is on.</p></div></div><div class="src-link"><a href="https://github.com/metametadata/carry/blob/master/contrib/history/src/carry_history/core.cljs#L146">view source</a></div></div><div class="public anchor" id="var-HistoryProtocol"><h3>HistoryProtocol</h3><h4 class="type">protocol</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="members"><h4>members</h4><div class="inner"><div class="public anchor" id="var-token-.3Ehref"><h3>token-&gt;href</h3><div class="usage"><code>(token-&gt;href this token)</code></div><div class="doc"><div class="markdown"><p>Returns the href for the specified token to be used in HTML links.</p></div></div></div><div class="public anchor" id="var-replace-token"><h3>replace-token</h3><div class="usage"><code>(replace-token this token)</code><code>(replace-token this token event-data)</code></div><div class="doc"><div class="markdown"><p>Replace token and fire an event with additional data passed (data is nil if not specified); do nothing if current token is already equal to the specified one.</p></div></div></div><div class="public anchor" id="var-push-token"><h3>push-token</h3><div class="usage"><code>(push-token this token)</code><code>(push-token this token event-data)</code></div><div class="doc"><div class="markdown"><p>Push token and fire an event with additional data passed (data is nil if not specified); do nothing if current token is already equal to the specified one.</p></div></div></div><div class="public anchor" id="var-token"><h3>token</h3><div class="usage"><code>(token this)</code></div><div class="doc"><div class="markdown"><p>Return current token.</p></div></div></div><div class="public anchor" id="var-listen"><h3>listen</h3><div class="usage"><code>(listen this callback)</code></div><div class="doc"><div class="markdown"><p>Starts calling back on history events. Callback function signature: [token browser-event? event-data], where:  token - new token  browser-event? - true if event was initiated by action in browser, e.g. clicking Back button  event-data - data which was passed from replace-token/push-token Returns a function which stops listening.</p></div></div></div></div></div><div class="src-link"><a href="https://github.com/metametadata/carry/blob/master/contrib/history/src/carry_history/core.cljs#L11">view source</a></div></div><div class="public anchor" id="var-link"><h3>link</h3><div class="usage"><code>(link history token {:keys [replace?], :as attrs} &amp; body)</code></div><div class="doc"><div class="markdown"><p>Link Reagent component which changes current URL without sending request to server. Will replace current token instead of pushing if :replace? attribute is true (attribute is false by default).</p>
<p>If history middleware is added then clicking the link will produce :on-enter signal.</p></div></div><div class="src-link"><a href="https://github.com/metametadata/carry/blob/master/contrib/history/src/carry_history/core.cljs#L182">view source</a></div></div><div class="public anchor" id="var-new-hash-history"><h3>new-hash-history</h3><div class="usage"><code>(new-hash-history)</code></div><div class="doc"><div class="markdown"><p>For history management using hashes based on onhashchange event. Will not correctly work in Opera Mini: <a href="http://caniuse.com/#search=hash">http://caniuse.com/#search=hash</a></p></div></div><div class="src-link"><a href="https://github.com/metametadata/carry/blob/master/contrib/history/src/carry_history/core.cljs#L67">view source</a></div></div><div class="public anchor" id="var-new-history"><h3>new-history</h3><div class="usage"><code>(new-history)</code></div><div class="doc"><div class="markdown"><p>For history management using pushState. Supported browsers: <a href="http://caniuse.com/#search=pushstate">http://caniuse.com/#search=pushstate</a></p></div></div><div class="src-link"><a href="https://github.com/metametadata/carry/blob/master/contrib/history/src/carry_history/core.cljs#L75">view source</a></div></div><div class="public anchor" id="var-new-legacy-hash-history"><h3>new-legacy-hash-history</h3><div class="usage"><code>(new-legacy-hash-history)</code></div><div class="doc"><div class="markdown"><p>For history management using hashes. Should work in Opera Mini.</p></div></div><div class="src-link"><a href="https://github.com/metametadata/carry/blob/master/contrib/history/src/carry_history/core.cljs#L60">view source</a></div></div></div></body></html>